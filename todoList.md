# gym-booking-system ç¾ä»£åŒ–æ”¹é€ è—åœ–

æœ¬æ–‡ä»¶æ—¨åœ¨è¿½è¹¤å°‡ç³»çµ±å¾Œç«¯å¾ Google Sheets é·ç§»è‡³ Supabase çš„æ‰€æœ‰å¾…è¾¦äº‹é …ã€‚

## æ ¸å¿ƒç†å¿µ

- **è®€å–æ“ä½œ (Read)**: ç›¡å¯èƒ½è®“å‰ç«¯ (HTML) ç›´æ¥å‘ Supabase è«‹æ±‚è³‡æ–™ï¼Œä»¥ç²å¾—æœ€ä½³æ•ˆèƒ½ã€‚é€é RLS (Row Level Security) ç¢ºä¿è³‡æ–™å®‰å…¨ã€‚
- **å¯«å…¥æ“ä½œ (Write)**: æ‰€æœ‰æ¶‰åŠè³‡æ–™æ–°å¢ã€ä¿®æ”¹ã€åˆªé™¤çš„æ•æ„Ÿæ“ä½œï¼Œä¿ç•™åœ¨å¾Œç«¯ Google Apps Script (`Code.gs`) ä¸­è™•ç†ï¼Œä»¥ç¢ºä¿äº¤æ˜“çš„åŸå­æ€§å’Œå®‰å…¨æ€§ã€‚

---

## âœ… å·²å®Œæˆ (Phase 1: è®€å–æ“ä½œé©å‘½)

- [x] **è³‡æ–™åº«é·ç§»**:
  - [x] åœ¨ Supabase ä¸­å»ºç«‹æ‰€æœ‰è³‡æ–™è¡¨ (`users`, `courses`, `classes` ç­‰)ã€‚
  - [x] é€éä¸€æ¬¡æ€§ GAS è…³æœ¬å°‡æ‰€æœ‰è³‡æ–™å¾ Google Sheets é·ç§»è‡³ Supabaseã€‚
- [x] **ä½¿ç”¨è€…ç«¯ - èª²ç¨‹åˆ—è¡¨ (`courses.html`)**:
  - [x] å‡ç´šç‚ºå‰ç«¯ç›´é€£ Supabaseã€‚
  - [x] ç‚º `courses` è¡¨è¨­å®š RLS å®‰å…¨è¦å‰‡ã€‚
- [x] **ä½¿ç”¨è€…ç«¯ - èª²è¡¨é  (`schedule.html`)**:
  - [x] å‡ç´šç‚ºå‰ç«¯ç›´é€£ Supabaseã€‚
  - [x] ç‚º `classes` è¡¨è¨­å®š RLS å®‰å…¨è¦å‰‡ã€‚
  - [x] è§£æ±ºæ™‚å€å•é¡Œï¼Œç¢ºä¿èª²è¡¨æ™‚é–“é¡¯ç¤ºæ­£ç¢ºã€‚
- [x] **ä½¿ç”¨è€…ç«¯ - é ç´„æ†‘è­‰ (`booking-details.html`)**:
  - [x] å‡ç´šå¾Œç«¯ `getBookingDetails` å‡½å¼ï¼Œæ”¹ç‚ºå¾ Supabase è®€å–è³‡æ–™ï¼Œè§£æ±ºè³‡æ–™ä¸ä¸€è‡´å•é¡Œã€‚
- [x.5] **ç®¡ç†å¾Œå° - é ç´„ç®¡ç† (`manager.html` - æŸ¥è©¢éƒ¨åˆ†)**:
  - [x] å»ºç«‹ `search_bookings` RPC å‡½å¼ï¼Œè™•ç†è¤‡é›œçš„é—œè¯æŸ¥è©¢èˆ‡ç¯©é¸ã€‚
  - [x] å°‡ã€Œé ç´„ç®¡ç†ã€åˆ†é çš„è³‡æ–™è®€å–å‡ç´šç‚ºå‰ç«¯ç›´é€£ï¼Œå‘¼å« RPC å‡½å¼ã€‚

---

## â³ å¾…è¾¦äº‹é … (Phase 2: å¯«å…¥æ“ä½œé·ç§» & å¾Œå°å®Œå–„)

### ğŸš€ æœ€é«˜å„ªå…ˆç´š

- [ ] **ä½¿ç”¨è€…ç«¯ - å»ºç«‹é ç´„ (`createBooking`)**:
  - [ ] **ç›®æ¨™**: æ”¹é€  `Code.gs` ä¸­çš„ `createBooking` å‡½å¼ã€‚
  - [ ] **ä½œæ³•**:
    - [ ] å»ºç«‹ä¸€å€‹ Supabase RPC å‡½å¼ `create_booking_atomic`ï¼Œè©²å‡½å¼èƒ½ä»¥ã€ŒåŸå­æ€§ã€æ–¹å¼å®Œæˆä»¥ä¸‹æ“ä½œï¼š
      1. æª¢æŸ¥èª²å ‚ (`classes`) æ˜¯å¦é¡æ»¿ã€‚
      2. æ–°å¢ä¸€ç­†é ç´„ç´€éŒ„åˆ° `bookings` è¡¨ã€‚
      3. æ›´æ–° `classes` è¡¨çš„ `current_students` äººæ•¸ã€‚
    - [ ] ä¿®æ”¹ `Code.gs` ä¸­çš„ `createBooking`ï¼Œè®“å®ƒå‘¼å«é€™å€‹æ–°çš„ RPC å‡½å¼ã€‚

### ğŸ’» ç®¡ç†å¾Œå° (`manager.html`)

- [ ] **é ç´„ç®¡ç† (å¯«å…¥)**:
  - [ ] æ”¹é€  `reviewBooking` å‡½å¼ï¼Œå°‡ã€Œç¢ºèªæ‰£æ¬¾ã€å’Œã€Œå–æ¶ˆé ç´„ã€çš„é‚è¼¯æ”¹ç‚ºç›´æ¥æ“ä½œ Supabaseã€‚
- [ ] **èª²è¡¨ç®¡ç†**:
  - [ ] å‡ç´š `loadManagerSchedule` (è®€å–) ç‚ºå‰ç«¯ç›´é€£ã€‚
  - [ ] æ”¹é€  `saveClass` å’Œ `deleteClass` (å¯«å…¥)ã€‚
- [ ] **èª²ç¨‹å‹éŒ„ç®¡ç†**:
  - [ ] å‡ç´š `loadCourses` (è®€å–) ç‚ºå‰ç«¯ç›´é€£ã€‚
  - [ ] æ”¹é€  `saveCourse` å’Œ `deleteCourse` (å¯«å…¥)ã€‚
- [ ] **å®¢æˆ¶ç®¡ç†**:
  - [ ] å‡ç´š `loadUsers` (è®€å–) ç‚ºå‰ç«¯ç›´é€£ã€‚
  - [ ] æ”¹é€  `updateUserPoints` (å¯«å…¥)ã€‚
- [ ] **æ•™ç·´ç®¡ç†**:
  - [ ] å‡ç´š `loadCoaches` (è®€å–) ç‚ºå‰ç«¯ç›´é€£ã€‚
  - [ ] æ”¹é€  `saveCoach` å’Œ `deleteCoach` (å¯«å…¥)ã€‚